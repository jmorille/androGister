<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security" xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
				http://www.springframework.org/schema/beans/spring-beans.xsd
				http://www.springframework.org/schema/security
				http://www.springframework.org/schema/security/spring-security.xsd
				http://www.springframework.org/schema/context
				http://www.springframework.org/schema/context/spring-context.xsd">

  <context:property-placeholder location="classpath:/androgister.properties" />

  <global-method-security pre-post-annotations="enabled" />

  <!-- <http pattern="/app/static/**" security="none"/> -->
  <!-- <http pattern="/app/login*" security="none"/> -->
  <!-- <http pattern="/app/register/**" security="none"/> -->
  <!-- <http pattern="/app/lostpassword/**" security="none"/> -->

  <http pattern="/app/spring_security_login" security="none" />

  <http auto-config="true" use-expressions="true" create-session="stateless">
    <!-- <remember-me key="androGisterRememberKey" use-secure-cookie="true" token-validity-seconds="2592000" /> -->
    <intercept-url pattern="/app/404-error" access="permitAll()" />
    <intercept-url pattern="/app/500-error" access="permitAll()" />
    <!-- <intercept-url pattern="/app/rest/users" method="POST" access="permitAll()"/> -->
    <intercept-url pattern="/metrics/**" access="hasRole('ROLE_ADMIN')" />
    <intercept-url pattern="/**" access="isAuthenticated()" />

    <form-login default-target-url="/rest/users" />

    <!-- <form-login authentication-success-handler-ref="appAuthenticationSuccessHandler" /> -->
    <!-- <form-login -->
    <!-- login-processing-url="/app/authentication" -->
    <!-- login-page="/app/login" -->
    <!-- authentication-failure-url="/app/login?action=loginFailure" -->
    <!-- default-target-url="/app/" -->
    <!-- authentication-success-handler-ref="appAuthenticationSuccessHandler"/> -->
    <!-- <http-basic /> -->
    <logout logout-url="/app/logout" logout-success-url="/app/login" />


  </http>

  <!-- TODO SecurityContextPersistenceFilter -->
  <authentication-manager>
    <authentication-provider ref="daoAuthenticationProvider" />
    <!-- <authentication-provider> -->
    <!-- <password-encoder hash="sha"/> -->
    <!-- <user-service> -->
    <!-- <user name="admin" password="d033e22ae348aeb5660fc2140aec35850c4da997" authorities="ROLE_USER, ROLE_ADMIN" /> -->
    <!-- <user name="jimi" password="d7e6351eaa13189a5a3641bab846c8e8c69ba39f" authorities="ROLE_USER, ROLE_ADMIN" /> -->
    <!-- </user-service> -->
    <!-- </authentication-provider> -->
  </authentication-manager>


  <bean id="serviceProperties" class="org.springframework.security.cas.ServiceProperties">
    <property name="service" value="https://localhost:8443/castore/j_spring_cas_security_check" />
    <property name="sendRenew" value="false" />
  </bean>



  <beans:bean id="daoAuthenticationProvider" class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
    <beans:property name="userDetailsService" ref="appUserDetailsService" />
    <beans:property name="passwordEncoder">
      <beans:bean class="org.springframework.security.crypto.password.StandardPasswordEncoder" />
    </beans:property>
  </beans:bean>


</beans:beans>